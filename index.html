<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>思考ツリー・プロトタイプ</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #f4f4f4; margin: 0; padding: 20px; }
    h1 { margin-bottom: 10px; }
    #tree { margin-top: 20px; }
    .node {
      border: 1px solid #333;
      background: white;
      padding: 6px 10px;
      border-radius: 5px;
      display: inline-block;
      margin: 10px;
      cursor: pointer;
    }
    .branch {
      margin-left: 30px;
    }
    .option-container {
      margin-top: 10px;
    }
    .add-options {
      background: #fff;
      border: 1px solid #ccc;
      padding: 10px;
      margin-top: 5px;
      display: inline-block;
      border-radius: 5px;
      text-align: left;
    }
    .hidden {
      display: none;
    }
    button {
      margin: 5px;
      padding: 8px 12px;
      font-size: 13px;
      border-radius: 5px;
      border: none;
      background: #333;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #555;
    }
  </style>
</head>
<body>
  <h1>思考ツリー・プロトタイプ</h1>
  <div id="tree"></div>

  <script>
    const root = { text: "主ノード：テーマを入力", children: [] };

    function renderTree(node, container) {
      const div = document.createElement("div");
      div.className = "node";
      div.textContent = node.text;
      div.onclick = () => {
        const newText = prompt("ノードを編集", node.text);
        if (newText) {
          node.text = newText;
          updateTree();
        }
      };
      container.appendChild(div);

      const controlDiv = document.createElement("div");
      controlDiv.className = "option-container";

      const formDiv = document.createElement("div");
      formDiv.className = "add-options hidden";

      const options = [
        "選択肢を広げますか",
        "それを深く思考しますか",
        "想像力を伸ばしてみますか",
        "反論を考えますか",
        "アイデアを増やしますか"
      ];

      options.forEach((option, index) => {
        const label = document.createElement("label");
        label.innerHTML = `<input type="radio" name="opt-${node.text}" value="${option}"> ${option}<br>`;
        formDiv.appendChild(label);
      });

      const confirmBtn = document.createElement("button");
      confirmBtn.textContent = "追加";
      confirmBtn.onclick = () => {
        const selected = formDiv.querySelector("input[type='radio']:checked");
        if (selected) {
          node.children.push({ text: selected.value, children: [] });
          updateTree();
        }
      };
      formDiv.appendChild(confirmBtn);

      const addBtn = document.createElement("button");
      addBtn.textContent = "＋枝を追加";
      addBtn.onclick = () => {
        formDiv.classList.toggle("hidden");
      };

      controlDiv.appendChild(addBtn);
      controlDiv.appendChild(formDiv);
      container.appendChild(controlDiv);

      if (node.children.length > 0) {
        const branchDiv = document.createElement("div");
        branchDiv.className = "branch";
        node.children.forEach(child => renderTree(child, branchDiv));
        container.appendChild(branchDiv);
      }
    }

    function updateTree() {
      const treeDiv = document.getElementById("tree");
      treeDiv.innerHTML = "";
      renderTree(root, treeDiv);
    }

    updateTree();
  </script>
</body>
</html>
